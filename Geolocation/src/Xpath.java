import org.w3c.dom.*;

import javax.xml.xpath.*;
import javax.xml.namespace.NamespaceContext;
import javax.xml.parsers.*;

import java.io.IOException;

import org.xml.sax.SAXException;	

import java.util.Iterator;

public class Xpath {

	  DocumentBuilderFactory domFactory = DocumentBuilderFactory.newInstance();
	  Document doc;
	  
	  public void init(String xmlStr) throws ParserConfigurationException, SAXException, IOException {
		  domFactory.setNamespaceAware(true); 

			DocumentBuilderFactory xmlFact =
				DocumentBuilderFactory.newInstance();
			xmlFact.setNamespaceAware(true);
			DocumentBuilder builder = xmlFact.newDocumentBuilder();
			doc = builder.parse(
					new java.io.ByteArrayInputStream(
							xmlStr.getBytes()));
	  }
	  
	  public String getValue( String xpathString, String countFlag) throws ParserConfigurationException, SAXException, IOException, XPathExpressionException {

		  
		  XPath xpath = XPathFactory.newInstance().newXPath();
		  
		  //XPathExpression expr = xpath.compile("/GeocodeResponse/status/text()");
		  XPathExpression expr = xpath.compile(xpathString);
		  Object result = expr.evaluate(doc, XPathConstants.NODESET);
		  NodeList nodes = (NodeList) result;
		  //for (int i = 0; i < nodes.getLength(); i++) {
		  //   System.out.println(nodes.item(0).getNodeValue()); 
		  //}		
		
		if (countFlag.equals("Y")) 
		{
			return nodes.getLength()+"";			
		} else {
			return nodes.item(0).getNodeValue();
		}
		  
	}
	
	public static void main(String[] args) throws ParserConfigurationException, SAXException, IOException, XPathExpressionException {
		String xmlStr =
				"<?xml version=\"1.0\" encoding=\"UTF-8\"?><GeocodeResponse> <status>OK</status> <result>  <type>hospital</type>  <type>point_of_interest</type>  <type>establishment</type>  <formatted_address>Address, 28039 Madrid, Madrid, Spain</formatted_address>  <address_component>   <long_name>Address</long_name>   <short_name>Address</short_name>   <type>point_of_interest</type>   <type>establishment</type>  </address_component>  <address_component>   <long_name>Madrid</long_name>   <short_name>Madrid</short_name>   <type>locality</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Madrid</long_name>   <short_name>M</short_name>   <type>administrative_area_level_2</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Community of Madrid</long_name>   <short_name>Community of Madrid</short_name>   <type>administrative_area_level_1</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Spain</long_name>   <short_name>ES</short_name>   <type>country</type>   <type>political</type>  </address_component>  <address_component>   <long_name>28039</long_name>   <short_name>28039</short_name>   <type>postal_code</type>  </address_component>  <geometry>   <location>    <lat>40.4473370</lat>    <lng>-3.7070179</lng>   </location>   <location_type>APPROXIMATE</location_type>   <viewport>    <southwest>     <lat>40.4459880</lat>     <lng>-3.7083669</lng>    </southwest>    <northeast>     <lat>40.4486860</lat>     <lng>-3.7056689</lng>    </northeast>   </viewport>  </geometry> </result> <result>  <type>point_of_interest</type>  <type>establishment</type>  <formatted_address>Address:, Pineville, NC 28134, USA</formatted_address>  <address_component>   <long_name>Address:</long_name>   <short_name>Address:</short_name>   <type>point_of_interest</type>   <type>establishment</type>  </address_component>  <address_component>   <long_name>Pineville</long_name>   <short_name>Pineville</short_name>   <type>locality</type>   <type>political</type>  </address_component>  <address_component>   <long_name>1, Charlotte</long_name>   <short_name>1, Charlotte</short_name>   <type>administrative_area_level_3</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Mecklenburg County</long_name>   <short_name>Mecklenburg County</short_name>   <type>administrative_area_level_2</type>   <type>political</type>  </address_component>  <address_component>   <long_name>North Carolina</long_name>   <short_name>NC</short_name>   <type>administrative_area_level_1</type>   <type>political</type>  </address_component>  <address_component>   <long_name>United States</long_name>   <short_name>US</short_name>   <type>country</type>   <type>political</type>  </address_component>  <address_component>   <long_name>28134</long_name>   <short_name>28134</short_name>   <type>postal_code</type>  </address_component>  <geometry>   <location>    <lat>35.0420310</lat>    <lng>-80.8630660</lng>   </location>   <location_type>APPROXIMATE</location_type>   <viewport>    <southwest>     <lat>35.0406820</lat>     <lng>-80.8644150</lng>    </southwest>    <northeast>     <lat>35.0433800</lat>     <lng>-80.8617170</lng>    </northeast>   </viewport>  </geometry> </result> <result>  <type>point_of_interest</type>  <type>establishment</type>  <formatted_address>Address, D3/ 510, Kanpur Rd, Sector-I, Sector H, LDA colony, Lucknow, Uttar Pradesh 226012, India</formatted_address>  <address_component>   <long_name>Address</long_name>   <short_name>Address</short_name>   <type>point_of_interest</type>   <type>establishment</type>  </address_component>  <address_component>   <long_name>D3/ 510</long_name>   <short_name>D3/ 510</short_name>   <type>street_number</type>  </address_component>  <address_component>   <long_name>Kanpur Rd</long_name>   <short_name>Kanpur Rd</short_name>   <type>route</type>  </address_component>  <address_component>   <long_name>Sector-I</long_name>   <short_name>Sector-I</short_name>   <type>neighborhood</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Sector H</long_name>   <short_name>Sector H</short_name>   <type>sublocality_level_2</type>   <type>sublocality</type>   <type>political</type>  </address_component>  <address_component>   <long_name>LDA colony</long_name>   <short_name>LDA colony</short_name>   <type>sublocality_level_1</type>   <type>sublocality</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Lucknow</long_name>   <short_name>Lucknow</short_name>   <type>locality</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Lucknow</long_name>   <short_name>Lucknow</short_name>   <type>administrative_area_level_2</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Uttar Pradesh</long_name>   <short_name>UP</short_name>   <type>administrative_area_level_1</type>   <type>political</type>  </address_component>  <address_component>   <long_name>India</long_name>   <short_name>IN</short_name>   <type>country</type>   <type>political</type>  </address_component>  <address_component>   <long_name>226012</long_name>   <short_name>226012</short_name>   <type>postal_code</type>  </address_component>  <geometry>   <location>    <lat>26.7971340</lat>    <lng>80.9183080</lng>   </location>   <location_type>APPROXIMATE</location_type>   <viewport>    <southwest>     <lat>26.7957850</lat>     <lng>80.9169590</lng>    </southwest>    <northeast>     <lat>26.7984830</lat>     <lng>80.9196570</lng>    </northeast>   </viewport>  </geometry> </result> <result>  <type>premise</type>  <formatted_address>Address, 3 Sweet Fern Lane, Coventry, RI 02816, USA</formatted_address>  <address_component>   <long_name>Address</long_name>   <short_name>Address</short_name>   <type>premise</type>  </address_component>  <address_component>   <long_name>3</long_name>   <short_name>3</short_name>   <type>street_number</type>  </address_component>  <address_component>   <long_name>Sweet Fern Lane</long_name>   <short_name>Sweet Fern Ln</short_name>   <type>route</type>  </address_component>  <address_component>   <long_name>Coventry</long_name>   <short_name>Coventry</short_name>   <type>locality</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Kent County</long_name>   <short_name>Kent County</short_name>   <type>administrative_area_level_2</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Rhode Island</long_name>   <short_name>RI</short_name>   <type>administrative_area_level_1</type>   <type>political</type>  </address_component>  <address_component>   <long_name>United States</long_name>   <short_name>US</short_name>   <type>country</type>   <type>political</type>  </address_component>  <address_component>   <long_name>02816</long_name>   <short_name>02816</short_name>   <type>postal_code</type>  </address_component>  <geometry>   <location>    <lat>41.6763577</lat>    <lng>-71.5372181</lng>   </location>   <location_type>ROOFTOP</location_type>   <viewport>    <southwest>     <lat>41.6750087</lat>     <lng>-71.5385671</lng>    </southwest>    <northeast>     <lat>41.6777067</lat>     <lng>-71.5358691</lng>    </northeast>   </viewport>  </geometry> </result> <result>  <type>premise</type>  <formatted_address>Japan, 〒569-0064 Osaka Prefecture, Takatsuki, Shodokorocho, 7 ａｄｄｒｅｓｓ</formatted_address>  <address_component>   <long_name>ａｄｄｒｅｓｓ</long_name>   <short_name>ａｄｄｒｅｓｓ</short_name>   <type>premise</type>  </address_component>  <address_component>   <long_name>7</long_name>   <short_name>7</short_name>   <type>sublocality_level_3</type>   <type>sublocality</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Shodokorocho</long_name>   <short_name>Shodokorocho</short_name>   <type>sublocality_level_1</type>   <type>sublocality</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Takatsuki</long_name>   <short_name>Takatsuki</short_name>   <type>locality</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Osaka Prefecture</long_name>   <short_name>Osaka Prefecture</short_name>   <type>administrative_area_level_1</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Japan</long_name>   <short_name>JP</short_name>   <type>country</type>   <type>political</type>  </address_component>  <address_component>   <long_name>569-0065</long_name>   <short_name>569-0065</short_name>   <type>postal_code</type>  </address_component>  <geometry>   <location>    <lat>34.8398268</lat>    <lng>135.6145553</lng>   </location>   <location_type>ROOFTOP</location_type>   <viewport>    <southwest>     <lat>34.8384843</lat>     <lng>135.6131964</lng>    </southwest>    <northeast>     <lat>34.8411822</lat>     <lng>135.6158943</lng>    </northeast>   </viewport>   <bounds>    <southwest>     <lat>34.8398113</lat>     <lng>135.6145126</lng>    </southwest>    <northeast>     <lat>34.8398552</lat>     <lng>135.6145781</lng>    </northeast>   </bounds>  </geometry> </result> <result>  <type>premise</type>  <formatted_address>Japan, 〒310-0021 Ibaraki Prefecture, Mito, Minamimachi, 2 Chome−4 ＡＤＤＲＥＳＳ</formatted_address>  <address_component>   <long_name>ＡＤＤＲＥＳＳ</long_name>   <short_name>ＡＤＤＲＥＳＳ</short_name>   <type>premise</type>  </address_component>  <address_component>   <long_name>4</long_name>   <short_name>4</short_name>   <type>sublocality_level_3</type>   <type>sublocality</type>   <type>political</type>  </address_component>  <address_component>   <long_name>2 Chome</long_name>   <short_name>2 Chome</short_name>   <type>sublocality_level_2</type>   <type>sublocality</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Minamimachi</long_name>   <short_name>Minamimachi</short_name>   <type>sublocality_level_1</type>   <type>sublocality</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Mito</long_name>   <short_name>Mito</short_name>   <type>locality</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Ibaraki Prefecture</long_name>   <short_name>Ibaraki Prefecture</short_name>   <type>administrative_area_level_1</type>   <type>political</type>  </address_component>  <address_component>   <long_name>Japan</long_name>   <short_name>JP</short_name>   <type>country</type>   <type>political</type>  </address_component>  <address_component>   <long_name>310-0021</long_name>   <short_name>310-0021</short_name>   <type>postal_code</type>  </address_component>  <geometry>   <location>    <lat>36.3751785</lat>    <lng>140.4718554</lng>   </location>   <location_type>ROOFTOP</location_type>   <viewport>    <southwest>     <lat>36.3738298</lat>     <lng>140.4705095</lng>    </southwest>    <northeast>     <lat>36.3765278</lat>     <lng>140.4732074</lng>    </northeast>   </viewport>   <bounds>    <southwest>     <lat>36.3751499</lat>     <lng>140.4718129</lng>    </southwest>    <northeast>     <lat>36.3752077</lat>     <lng>140.4719040</lng>    </northeast>   </bounds>  </geometry> </result></GeocodeResponse>";

		Xpath x = new Xpath();
		x.init(xmlStr);
		System.out.println( x.getValue("/GeocodeResponse/status/text()","N") );
		System.out.println( x.getValue("/GeocodeResponse/result/geometry/location/lat/text()","N") );
		System.out.println( x.getValue("/GeocodeResponse/result/geometry/location/lng/text()","N") );
		System.out.println( x.getValue("/GeocodeResponse/result/geometry/location/lat/text()","Y") );
		
		
		  }	
	
}
